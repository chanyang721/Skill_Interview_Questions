> 컨설턴트유저, 피상담자 테이블 생성

- 유저 테이블에 같이 존재하는 컨설턴트 유저와 다른 유저 사이의 관계를 저장하여 별점, 내용, 날짜 등의 데이터를 저장 할 테이블(ConsultingConnections)을 생성한다. 그리고 해당 유저 간 연결 관계의 Key값을 FK로 가진 댓글 테이블(ConsultingMessages)을 생성한다.
- 현재는 하나의 문의 당 하나의 댓글만 담기면 된다고 하지만, 추 후에 혹시 모를 대댓글 기능을 위해서 댓글 간 root와 child 관계를 맺기 위해 parent_comment_key를 설정한다.
  - root 노드 Row
    - parent_commect_key = null
    - consulting_connection_key = (ConsultingConnections Key)
  - child 노드 Row
    - parent_commect_key = (ConsultingMessages Key)
    - consulting_connection_key = (ConsultingConnections Key)

> 컨설턴트 유저에게 전달된 문의 사항의 댓글 관계 테이블 설정

- 위와 같은 형식으로 만들며 생각한 것은 CRUD를 진행할 때 컨설턴트와 사용자 각각의 아이디로 어떤 컨설팅을 진행했는지에 대한 데이터를 가져오기 쉽게 만드는 것, 그리고 데이터의 성격에 따라 테이블에 나눠서 저장하는 것에 집중하였다.
  - ConsultingConnections
    - User 테이블에서 두개의 서로 다른 Key를 가져오는 OneToMany 관계를 두개 생성하여 컨설턴트, 컨설티드 id로 연결
    - 평가, 타이틀, 영역, 등 연결 관계를 정의
  - ConsultingMessages
    - 위의 테이블의 Key를 가져와서 디테일한 댓글을 저장하고 댓글 간 연결 관계를 생성하여 쿼리시에 연결된 댓글들을 관계에 root node만 가져와도 child 댓글들을 고구마 줄기 빼듯이 손쉽게 가져온다.

---

### 느낀점

- 최근 새로운 기능을 추가하기 위한 테이블 생성하는 일이 늘어났다. 이전에 만들어 둔 기능들이 안정화되었고, 리팩터링이 필요한 시기이자 새로운 기능에 대한 현재의 최선을 구조를 가지고 만드는 것이 집중해한다고 생각되었다.
- 목표 - ( 자산, 부채 ) - 각각 연결 관계 테이블, 유저 - 기관 테이블, 기관 유저에 따른 토큰 권한 부여, 그리고 이번에 진행하는 컨설턴트 - 컨설티드 유저 관계 테이블 및 이와 관련된 댓글 테이블을 직접 요구 사항에 따른 구조를 생각하여 설계하면서 어떻게 하면 서버에서 쿼리할 때 각 데이터를 효과적으로 CRUD를 진행할 수 있을지에 대한 고민을 하는
- 테이블 간 옳바른 관계를 맺는 것도 매우 중요하지만, 해당 테이블의 연결 옵션을 요구 사항이나 기능에 맞게 설정해야 오류가 없이 돌아가게 된는 것을 알았다.
